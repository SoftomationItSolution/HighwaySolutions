"use strict";(self.webpackChunkTMS_LaneApp=self.webpackChunkTMS_LaneApp||[]).push([[215],{8215:(oe,N,p)=>{p.r(N),p.d(N,{DefaultLayoutModule:()=>ae});var O=p(4408),u=p(6223),h=p(7700),Z=p(8645),q=p(9773),e=p(5879),g=p(7908),y=p(9540);let V=(()=>{var a;class r{constructor(s,t,n,i){this.Dialogref=s,this.dialog=t,this.dataModel=i,this.SubClassDetails=n}ngOnInit(){}onVehicleChange(s){let t=this.SubClassDetails.filter(n=>n.SystemVehicleSubClassId==s);t=t.length>0?t[0]:null,this.Dialogref.close(t)}}return(a=r).\u0275fac=function(s){return new(s||a)(e.Y36(h.so),e.Y36(h.uw),e.Y36(h.WI),e.Y36(g.v))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-sub-class-selection"]],decls:8,vars:2,consts:[[1,"modal-content","theam-bg"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],["optionLabel","SystemVehicleSubClassName","optionValue","SystemVehicleSubClassId",3,"options","filter","onChange"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"fieldset")(5,"legend"),e._uU(6,"Vehicle Sub Class Type"),e.qZA(),e.TgZ(7,"p-listbox",4),e.NdJ("onChange",function(i){return t.onVehicleChange(i.value)}),e.qZA()()()()()()),2&s&&(e.xp6(7),e.Q6J("options",t.SubClassDetails)("filter",!1))},dependencies:[y.Ri],encapsulation:2}),r})(),C=(()=>{var a;class r{constructor(s,t,n,i){this.Dialogref=s,this.dialog=t,this.dataModel=i,this.ExemptTypeDetails=n}ngOnInit(){}onExemptTypeChange(s){let t=this.ExemptTypeDetails.filter(n=>n.ExemptTypeId==s);t=t.length>0?t[0]:null,this.Dialogref.close(t)}}return(a=r).\u0275fac=function(s){return new(s||a)(e.Y36(h.so),e.Y36(h.uw),e.Y36(h.WI),e.Y36(g.v))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-exempt-selection"]],decls:8,vars:2,consts:[[1,"modal-content","theam-bg"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],["optionLabel","ExemptTypeName","optionValue","ExemptTypeId",3,"options","filter","onChange"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"fieldset")(5,"legend"),e._uU(6,"Exempt Type"),e.qZA(),e.TgZ(7,"p-listbox",4),e.NdJ("onChange",function(i){return t.onExemptTypeChange(i.value)}),e.qZA()()()()()()),2&s&&(e.xp6(7),e.Q6J("options",t.ExemptTypeDetails)("filter",!1))},dependencies:[y.Ri],encapsulation:2}),r})(),F=(()=>{var a;class r{constructor(s,t,n,i){this.Dialogref=s,this.dialog=t,this.dataModel=i,this.PaymentTypeDetails=n}ngOnInit(){}onPaymentTypeChange(s){let t=this.PaymentTypeDetails.filter(n=>n.PaymentTypeId==s);t=t.length>0?t[0]:null,this.Dialogref.close(t)}}return(a=r).\u0275fac=function(s){return new(s||a)(e.Y36(h.so),e.Y36(h.uw),e.Y36(h.WI),e.Y36(g.v))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-payment-selection"]],decls:8,vars:2,consts:[[1,"modal-content","theam-bg"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],["optionLabel","PaymentTypeName","optionValue","PaymentTypeId",3,"options","filter","onChange"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"fieldset")(5,"legend"),e._uU(6,"Payment Type"),e.qZA(),e.TgZ(7,"p-listbox",4),e.NdJ("onChange",function(i){return t.onPaymentTypeChange(i.value)}),e.qZA()()()()()()),2&s&&(e.xp6(7),e.Q6J("options",t.PaymentTypeDetails)("filter",!1))},dependencies:[y.Ri],encapsulation:2}),r})();var D=p(3579),v=p(8672);let w=(()=>{var a;class r{constructor(){this.messageSubject=new Z.x,this.currentIP="127.0.0.1",this.reconnectInterval=500,this.GetIpAddress()}GetIpAddress(){this.currentIP="";var s=window.location.href.split(":");this.currentIP=s[1].replace("//",""),this.connect()}connect(){try{const s=`ws://${this.currentIP}:6789`;console.log(s),this.socket=new WebSocket(s),this.socket.onmessage=t=>{this.messageSubject.next(t.data)},this.socket.onopen=t=>{console.log("WebSocket connection opened:",t)},this.socket.onclose=t=>{console.log("WebSocket connection closed:",t),this.handleReconnect()},this.socket.onerror=t=>{console.error("WebSocket error:",t),this.socket.close()}}catch(s){console.error("WebSocket connection error:",s),this.handleReconnect()}}handleReconnect(){console.log(`Reconnecting in ${this.reconnectInterval/1e3} seconds...`),setTimeout(()=>this.connect(),this.reconnectInterval)}getMessages(){return this.messageSubject.asObservable()}sendMessage(s){this.socket&&this.socket.readyState===WebSocket.OPEN?(this.socket.send(s),console.log("Message sent:",s)):console.log("WebSocket is not open. Unable to send message.")}}return(a=r).\u0275fac=function(s){return new(s||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),r})(),P=(()=>{var a;class r{constructor(s,t,n,i,o,c,m){this.Dialogref=s,this.dialog=t,this.dataModel=i,this.dbService=o,this.spinner=c,this.webSocketService=m,this.class_name="mdi mdi-road",this.FleetCount=0,this.customEventFunctions={},this.FleetTrans=n.data,this.keyEventList=n.KeyCode,this.messageSubscription=this.webSocketService.getMessages().subscribe(f=>{this.process_ws_message(f)})}ngOnInit(){}handleKeyboardEvent(s){"Enter"===s.key&&this.onFleetStop()}process_ws_message(s){try{let t=JSON.parse(s);const n=t.topic;"hardware_on_off_status"==n?20==t.EquipmentTypeId&&(this.class_name=t.PositionStatus?"mdi mdi-car-connected":"mdi mdi-road"):"fleet_count"==n&&(this.FleetCount=t.fleet_count)}catch(t){console.log(t)}}onFleetStop(){this.spinner.show(),this.dbService.FleetStop(this.FleetTrans).subscribe(s=>{this.spinner.hide();const t=s.message;"success"==t?this.Dialogref.close():this.DisplayMessage(t,!1)},s=>{this.spinner.hide(),this.DisplayMessage("Something went wrong !",!1)})}DisplayMessage(s,t){this.dataModel.openSnackBar([{AlertMessage:s}],t)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe()}}return(a=r).\u0275fac=function(s){return new(s||a)(e.Y36(h.so),e.Y36(h.uw),e.Y36(h.WI),e.Y36(g.v),e.Y36(D.t),e.Y36(v.t2),e.Y36(w))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-fleet-counter"]],hostBindings:function(s,t){1&s&&e.NdJ("keydown.enter",function(i){return t.handleKeyboardEvent(i)},!1,e.evT)},decls:11,vars:4,consts:[[1,"modal-content","theam-bg"],[1,"modal-body"],[1,"row"],[1,"col-md-12","fleet-popup"],[1,"icon-item","justify-content-center"],[1,"icon-label","justify-content-center"],[1,"modal-footer"],["type","button",1,"btn","btn-dark","wt-90",3,"click"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),e._UZ(5,"i"),e.qZA(),e.TgZ(6,"span",5),e._uU(7),e.qZA()()()(),e.TgZ(8,"div",6)(9,"button",7),e.NdJ("click",function(){return t.onFleetStop()}),e._uU(10,"Fleet-Stop"),e.qZA()()()),2&s&&(e.xp6(5),e.Tol(t.class_name),e.xp6(2),e.hij(" Total Vehicle Cross : ",t.FleetCount," "))},encapsulation:2}),r})();var T=p(6814),A=p(5219),b=p(434),x=p(9653),U=p(1865),R=p(3714);const J=["plateNumberInput"],W=["remarkInput"];function L(a,r){1&a&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"TID"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"EPC"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Date Time"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"VRN"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Class"),e.qZA()())}function Q(a,r){if(1&a&&(e.TgZ(0,"tr",58)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA()()),2&a){const l=r.$implicit;e.Q6J("pSelectableRow",l),e.xp6(2),e.Oqu(l.TID),e.xp6(2),e.Oqu(l.EPC),e.xp6(2),e.Oqu(l.TransactionDateTime),e.xp6(2),e.Oqu(l.Plate),e.xp6(2),e.Oqu(l.Class)}}function B(a,r){1&a&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Date Time"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Axle Count"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Total Weight"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Reverse Direction"),e.qZA()())}function Y(a,r){if(1&a&&(e.TgZ(0,"tr",58)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA()()),2&a){const l=r.$implicit;e.Q6J("pSelectableRow",l),e.xp6(2),e.Oqu(l.TransactionDateTime),e.xp6(2),e.Oqu(l.AxleCount),e.xp6(2),e.Oqu(l.TotalWeight),e.xp6(2),e.Oqu(l.IsReverseDirection)}}function j(a,r){1&a&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Id"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Type"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Vehicle"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Date Time"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Toll Fare"),e.qZA()())}function z(a,r){if(1&a&&(e.TgZ(0,"tr",58)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA()()),2&a){const l=r.$implicit;e.Q6J("pSelectableRow",l),e.xp6(2),e.Oqu(l.LaneTransactionId),e.xp6(2),e.Oqu(l.TransactionTypeName),e.xp6(2),e.AsE("",l.VehicleClassName,"-",l.VehicleSubClassName,""),e.xp6(2),e.Oqu(l.TransactionDateTime),e.xp6(2),e.Oqu(e.gM2(11,7,l.TransactionAmount,"INR","symbol","1.0-2"))}}function H(a,r){if(1&a&&(e.TgZ(0,"span",59),e._UZ(1,"i"),e.TgZ(2,"div",60),e._uU(3),e.qZA()()),2&a){const l=r.$implicit,s=e.oxw();e.xp6(1),e.Tol(s.getIconName(l)),e.xp6(2),e.Oqu(l.EquipmentTypeName)}}const _=function(a,r){return{"btn-outline-info":a,"btn-dark":r}},E=function(a,r){return{"btn-outline-warning":a,"btn-dark":r}};let $=(()=>{var a;class r{constructor(s,t,n,i,o){this.dbService=s,this.dm=t,this.spinner=n,this.webSocketService=i,this.dialog=o,this.laneRecentData=[],this.wimDataQueue=[],this.rfidDataQueue=[],this.equipmentListDetais=null,this.SystemSetting=null,this.selectedVehicleClasss=0,this.excludeIds=[24,6,25,13,8,11],this.CurrentTransactions=null,this.ttyselectedButton="",this.tteselectedButton="",this.FleetStart=!1,this.TowStart=!1,this.apiPath="",this.lpicViewUrl="",this.dialogRef=null,this.destroy$=new Z.x,this.customEventFunctions={},this.UserData=this.dm.getUserData()}ngOnInit(){this.FormDetails=new u.cw({TransactionTypeName:new u.NI("",[u.kI.required]),TransactionSubTypeName:new u.NI("",[u.kI.required]),VehicleClassName:new u.NI("",[u.kI.required]),VehicleClassSubName:new u.NI("",[u.kI.required]),JourneyTypeId:new u.NI("S",[u.kI.required]),PlateNumber:new u.NI("",[]),Remark:new u.NI("",[]),VehicleWeight:new u.NI("0",[]),TollFare:new u.NI("0",[]),OverweightPenalty:new u.NI("0",[]),TagPenalty:new u.NI("0",[])}),this.getLaneMasterData(),this.messageSubscription=this.webSocketService.getMessages().pipe((0,q.R)(this.destroy$)).subscribe(s=>{""!=s&&this.process_ws_message(s)},s=>console.error("WebSocket error:",s)),this.refreshImageUrl()}mapKeyEvents(){this.keyEventList.forEach(s=>{this.customEventFunctions[s.KeyCode]=()=>this.handleEvent(s)})}handleKeyDown(s){const t=s.keyCode||s.which;"Enter"===s.key?null==this.dialogRef&&this.submit_trans():this.customEventFunctions[t]&&(s.preventDefault(),this.customEventFunctions[t]())}handleEvent(s){if(1==s.EventTypeId){const t=this.VehicleSubClasss.filter(n=>n.SystemVehicleSubClassId==s.EventId);if(t.length>0){const n=t[0];this.selectedVehicleClasss=n.SystemVehicleClassId,this.createTrans("svc",n,null)}}else 2==s.EventTypeId?this.onttySeclect(s.EventId,s.EventName):this.call_general_events(s.EventName)}refreshImageUrl(){const s=(new Date).getTime();this.lpicViewUrl=this.dm.getDataAPI()+`/lpicLiveView?timestamp=${s}`}select_journey_type(s){null==this.CurrentTransactions?this.DisplayMessage("Cannot change the journey!",!1):2==this.CurrentTransactions.TransactionTypeId?this.FormDetails.controls.JourneyTypeId.setValue(s):this.DisplayMessage("Cannot change the journey!",!1)}call_general_events(s){switch(s){case"Digital Payment":case"Remark":this.remarkInput.nativeElement.focus();break;case"Single Journey":this.select_journey_type("S");break;case"Retrun Journey":this.select_journey_type("R");break;case"Reset":this.reset_form();break;case"Fleet Start":this.onFleetStart();break;case"WIM Reset":this.wimDataQueue.length>0&&this.wimDataQueue.shift();break;case"Plate Number":this.plateNumberInput.nativeElement.focus();break;default:console.log(`Unknown event: ${s}`)}}reset_form(){this.ttyselectedButton="",this.tteselectedButton="",this.FormDetails.reset(),this.FormDetails.controls.TransactionTypeName.setValue(""),this.FormDetails.controls.TransactionSubTypeName.setValue(""),this.FormDetails.controls.VehicleClassName.setValue(""),this.FormDetails.controls.VehicleClassSubName.setValue(""),this.FormDetails.controls.JourneyTypeId.setValue("S"),this.FormDetails.controls.PlateNumber.setValue(""),this.FormDetails.controls.Remark.setValue(""),this.FormDetails.controls.VehicleWeight.setValue(0),this.FormDetails.controls.TollFare.setValue(0),this.FormDetails.controls.OverweightPenalty.setValue(0),this.FormDetails.controls.TagPenalty.setValue(0),this.selectedVehicleClasss=0,null!=this.dialogRef&&this.dialogRef.close(),this.FleetStart=!1}getLaneMasterData(){this.spinner.show(),this.dbService.getLaneMasterData().subscribe(s=>{if(this.getLaneRecentData(),"success"==s.message){const n=s.ResponseData,i=n.master_data,o=n.hardware_list,c=n.equipment_detail,I=i[0].concat(i[1]);this.equipmentListDetais=I.filter(d=>!this.excludeIds.includes(d.EquipmentTypeId)),this.TransactionTypeMaster=i[2],this.PaymentTypeMaster=i[3],this.ExemptTypeMaster=i[4],this.VehicleClasss=i[5],this.VehicleSubClasss=i[6],this.ShiftTimining=i[7],this.TollFare=i[8],this.SystemSetting=i[9].length>0?i[9][0]:null,this.PlazaDetails=i[10],this.LaneDetails=i[11],this.keyEventList=i[12],this.mapKeyEvents(),o.forEach(d=>{this.updateEquipmentStatus(d.EquipmentTypeId,d.PositionStatus,"hardware_on_off_status")}),c.forEach(d=>{this.updateEquipmentStatus(d.EquipmentTypeId,d.OnLineStatus,"equipment_status")})}else this.DisplayMessage("Somthing went wrong!",!1)},s=>{this.spinner.hide(),this.DisplayMessage("Somthing went wrong!",!1)})}getLaneRecentData(){this.dbService.getLaneRecentData().subscribe(s=>{this.spinner.hide(),"success"==s.message?this.laneRecentData=s.ResponseData:this.DisplayMessage("Somthing went wrong!",!1)},s=>{this.spinner.hide(),this.DisplayMessage("Somthing went wrong!",!1)})}addTrsnaRow(s){this.laneRecentData.unshift(s),this.laneRecentData.length>10&&this.laneRecentData.pop()}DisplayMessage(s,t){this.dm.openSnackBar([{AlertMessage:s}],t)}bindData(s,t,n){if("vc"==s)this.CurrentTransactions.VehicleClassId=t.SystemVehicleClassId,this.CurrentTransactions.VehicleClassName=t.SystemVehicleClassName,this.CurrentTransactions.PermissibleVehicleWeight=t.PermissibleWeight,this.FormDetails.controls.VehicleClassName.setValue(t.SystemVehicleClassName),this.getTollFare();else if("svc"==s)t.SystemVehicleClassId>0&&(this.CurrentTransactions.VehicleClassId=t.SystemVehicleClassId,this.CurrentTransactions.VehicleClassName=t.SystemVehicleClassName,this.CurrentTransactions.PermissibleVehicleWeight=t.PermissibleWeight,this.FormDetails.controls.VehicleClassName.setValue(t.SystemVehicleClassName)),this.CurrentTransactions.VehicleSubClassId=t.SystemVehicleSubClassId,this.CurrentTransactions.VehicleSubClassName=t.SystemVehicleSubClassName,this.CurrentTransactions.PermissibleVehicleWeight=t.PermissibleWeight,this.FormDetails.controls.VehicleClassSubName.setValue(t.SystemVehicleSubClassName),this.getTollFare();else if("tt"==s){if(this.CurrentTransactions.TransactionTypeId=t.TransactionTypeId,this.CurrentTransactions.TransactionTypeName=t.TransactionTypeName,this.CurrentTransactions.PaymentTypeId=0,this.CurrentTransactions.ExemptTypeId=0,this.CurrentTransactions.PaymentTypeName="",this.CurrentTransactions.ExemptTypeName="",this.FormDetails.controls.TransactionTypeName.setValue(t.TransactionTypeName),this.FormDetails.controls.TransactionSubTypeName.setValue(""),this.FormDetails.controls.Remark.setValue(""),null!=n){const i=parseInt(n.Class);this.CurrentTransactions.TagEPC=n.EPC,this.CurrentTransactions.RCTNumber=n.TID,this.CurrentTransactions.TagPlateNumber=n.Plate,this.CurrentTransactions.TagReadDateTime=n.TransactionDateTime,this.CurrentTransactions.TagReadCount=0,this.CurrentTransactions.TagReadById=n.TagReadById,this.CurrentTransactions.TagClassId=i;let o=this.VehicleSubClasss.filter(c=>c.SystemVehicleSubClassId==i);o.length>0&&(o=o[0],this.CurrentTransactions.VehicleClassId=parseInt(n.Class),this.CurrentTransactions.VehicleSubClassId=parseInt(n.Class),o.SystemVehicleClassId>0&&(this.CurrentTransactions.VehicleClassId=o.SystemVehicleClassId,this.CurrentTransactions.VehicleClassName=o.SystemVehicleClassName,this.CurrentTransactions.PermissibleVehicleWeight=o.PermissibleWeight,this.FormDetails.controls.VehicleClassName.setValue(o.SystemVehicleClassName),this.selectedVehicleClasss=o.SystemVehicleClassId),this.CurrentTransactions.VehicleSubClassId=o.SystemVehicleSubClassId,this.CurrentTransactions.VehicleSubClassName=o.SystemVehicleSubClassName,this.CurrentTransactions.PermissibleVehicleWeight=o.PermissibleWeight,this.FormDetails.controls.VehicleClassSubName.setValue(o.SystemVehicleSubClassName))}this.getTollFare()}else"pt"==s?(this.CurrentTransactions.PaymentTypeId=t.PaymentTypeId,this.CurrentTransactions.PaymentTypeName=t.PaymentTypeName,this.FormDetails.controls.TransactionSubTypeName.setValue(t.PaymentTypeName),this.FormDetails.controls.Remark.setValue("")):"et"==s&&(this.CurrentTransactions.ExemptTypeId=t.ExemptTypeId,this.CurrentTransactions.ExemptTypeName=t.ExemptTypeName,this.FormDetails.controls.TransactionSubTypeName.setValue(t.ExemptTypeName),this.FormDetails.controls.Remark.setValue(t.ExemptTypeName))}getCurrentTransactions(s,t,n){this.dbService.getCurrentTransactions().subscribe(i=>{this.CurrentTransactions=i.ResponseData,this.bindData(s,t,n)},i=>{this.spinner.hide(),this.DisplayMessage("Somthing went wrong!",!1)})}createTrans(s,t,n){null==this.CurrentTransactions?this.getCurrentTransactions(s,t,n):this.bindData(s,t,n)}onVehicleChange(s){let t=this.VehicleClasss.filter(n=>n.SystemVehicleClassId==s);if(t=t.length>0?t[0]:null,null!=t){this.createTrans("vc",t,null);const n=this.VehicleSubClasss.filter(i=>i.SystemVehicleClassId==s);if(n.length>1){const i=new h.vA;i.disableClose=!0,i.autoFocus=!0,i.width="25%",i.data=n,this.dialogRef=this.dialog.open(V,i),this.dialogRef.afterClosed().subscribe(o=>{o&&(null!=o?(this.createTrans("svc",o,null),this.dialogRef=null):this.DisplayMessage("Wrong sub class selection!",!1))})}else 1==n.length?this.createTrans("svc",n[0],null):this.DisplayMessage("Wrong sub class selection!",!1)}else this.DisplayMessage("Wrong class selection!",!1)}ontteSeclect(s){1==s&&(this.TowStart?this.DisplayMessage("Stop the tow first!",!1):this.FleetStart=!this.FleetStart),2==s&&(this.FleetStart?this.DisplayMessage("Stop the fleet first!",!1):this.TowStart=!this.TowStart)}onttySeclect(s,t){if(this.ttyselectedButton=t,5!=s)if(this.createTrans("tt",{TransactionTypeId:s,TransactionTypeName:t},null),this.FormDetails.controls.JourneyTypeId.enable(),this.FormDetails.controls.JourneyTypeId.setValue("S"),this.FormDetails.controls.JourneyTypeId.disable(),2==s){this.FormDetails.controls.JourneyTypeId.enable();const i=new h.vA;i.disableClose=!0,i.autoFocus=!0,i.width="25%",i.data=this.PaymentTypeMaster,this.dialogRef=this.dialog.open(F,i),this.dialogRef.afterClosed().subscribe(o=>{o&&(null!=o?(this.createTrans("pt",o,null),this.dialogRef=null):this.DisplayMessage("Wrong payment type selection!",!1))})}else if(3==s){this.FormDetails.controls.JourneyTypeId.disable();const i=new h.vA;i.disableClose=!0,i.autoFocus=!0,i.width="25%",i.data=this.ExemptTypeMaster,this.dialogRef=this.dialog.open(C,i),this.dialogRef.afterClosed().subscribe(o=>{o&&(null!=o?(this.createTrans("et",o,null),this.dialogRef=null):this.DisplayMessage("Wrong exempt type selection!",!1))})}}process_ws_message(s){try{if(""!=s){let t=JSON.parse(s);const n=t.topic;if("equipment_status"==n)this.updateEquipmentStatus(t.EquipmentTypeId,t.OnLineStatus,n);else if("hardware_on_off_status"==n)this.updateEquipmentStatus(t.EquipmentTypeId,t.PositionStatus,n);else if("wim_processed"==n)this.process_wim_data(t);else if("rfid_processed"==n)this.process_rfid_data(t);else if("lane_process_end"==n&&(this.CurrentTransactions=null,this.getLaneRecentData(),this.reset_form(),this.rfidDataQueue.length>0)){const i=this.rfidDataQueue[0];this.rfidDataQueue.shift();const o={TransactionTypeId:1,TransactionTypeName:"FasTag"};this.ttyselectedButton=o.TransactionTypeName,this.createTrans("tt",o,i)}}}catch(t){console.error("Error parsing JSON:",t,"JSON string:",s)}}process_wim_data(s){this.wimDataQueue.push(s)}process_rfid_data(s){if(null==this.CurrentTransactions)if(0==this.rfidDataQueue.length){const t={TransactionTypeId:1,TransactionTypeName:"FasTag"};this.ttyselectedButton=t.TransactionTypeName,this.createTrans("tt",t,s)}else this.rfidDataQueue.push(s);else this.rfidDataQueue.push(s)}updateEquipmentStatus(s,t,n){if(null!=this.equipmentListDetais){const i=this.equipmentListDetais.find(o=>o.EquipmentTypeId===s);i&&("equipment_status"==n?i.OnLineStatus=t:"hardware_on_off_status"==n&&(i.PositionStatus=t))}}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe()}getIconName(s){let t=s.EquipmentIcon;const n=1===s.OnLineStatus||!0===s.OnLineStatus,i=1===s.ConnectionStatus||!0===s.ConnectionStatus,o=1===s.PositionStatus||!0===s.PositionStatus;try{const c=t.split("/");return t=2==c.length&&o?c[1]:c[0],1==s.ProtocolTypeId||2==s.ProtocolTypeId||4==s.ProtocolTypeId||5==s.ProtocolTypeId||6==s.ProtocolTypeId||8==s.ProtocolTypeId?n&&i?t+" txt-green":n?t+" txt-yellow":t+" txt-red":(t=o?c[1]+" txt-green":c[0]+" txt-red",t)}catch{return t}}getTollFare(){let s=null,t=null;null!=this.CurrentTransactions&&null!=this.SystemSetting&&null!=this.TollFare&&this.CurrentTransactions.TransactionTypeId>0&&(1==this.SystemSetting.TollFareonSubClass||1==this.SystemSetting.TollFareonSubClass?this.CurrentTransactions.VehicleSubClassId>0&&(s=this.TollFare.filter(n=>n.SubVehicleClassId==this.CurrentTransactions.VehicleSubClassId)):this.CurrentTransactions.VehicleClassId>0&&(s=this.TollFare.filter(n=>n.SystemVehicleClassId==this.CurrentTransactions.VehicleClassId))),null!=s&&s.length>0?(this.wimDataQueue.length>0&&(t=this.wimDataQueue[0],this.wimDataQueue.shift()),s=s[0],2==this.CurrentTransactions.TransactionTypeId?(this.FormDetails.controls.TollFare.setValue(s.TollFare),this.CurrentTransactions.TransactionAmount=s.TollFare,1==this.SystemSetting.FasTagPenalty||1==this.SystemSetting.FasTagPenalty?(this.CurrentTransactions.TagPenaltyAmount=s.FasTagPenalty,this.FormDetails.controls.TagPenalty.setValue(s.FasTagPenalty)):(this.CurrentTransactions.TagPenaltyAmount=0,this.FormDetails.controls.TagPenalty.setValue(0))):(this.CurrentTransactions.TransactionAmount=0,this.FormDetails.controls.TollFare.setValue(0),this.CurrentTransactions.TagPenaltyAmount=0,this.FormDetails.controls.TagPenalty.setValue(0))):(this.CurrentTransactions.TransactionAmount=0,this.CurrentTransactions.TagPenaltyAmount=0,this.CurrentTransactions.OverweightPenalty=0,this.FormDetails.controls.TollFare.setValue(0),this.FormDetails.controls.OverweightPenalty.setValue(0),this.FormDetails.controls.TagPenalty.setValue(0),this.CurrentTransactions.TransactionTypeId>0&&(this.CurrentTransactions.VehicleClassId>0||this.CurrentTransactions.VehicleSubClassId>0)&&this.DisplayMessage("Toll Fare not found for selected class !",!1)),null!=t?(this.CurrentTransactions.ActualVehicleWeight=t.TotalWeight,this.CurrentTransactions.ActualVehicleWeight>this.CurrentTransactions.PermissibleVehicleWeight&&null!=s?(this.CurrentTransactions.OverweightPenalty=s.OverweightPenalty,this.FormDetails.controls.OverweightPenalty.setValue(s.OverweightPenalty)):(this.CurrentTransactions.OverweightPenalty=0,this.FormDetails.controls.OverweightPenalty.setValue(0))):(this.CurrentTransactions.OverweightPenalty=0,this.FormDetails.controls.OverweightPenalty.setValue(0))}onFleetStart(){if(this.FleetStart)this.DisplayMessage("Fleet already running!",!1);else{this.FleetStart=!0;const s={TransactionTypeId:3,TransactionTypeName:"Excempt"};this.FormDetails.controls.JourneyTypeId.enable(),this.FormDetails.controls.JourneyTypeId.setValue("S"),this.FormDetails.controls.JourneyTypeId.disable(),this.createTrans("tt",s,null);const t=new h.vA;t.disableClose=!0,t.autoFocus=!0,t.width="25%",t.data=this.ExemptTypeMaster,this.dialogRef=this.dialog.open(C,t),this.dialogRef.afterClosed().subscribe(n=>{n&&(null!=n?(this.createTrans("et",n,null),this.dialogRef=null,this.CurrentTransactions.TCRemark=this.FormDetails.value.Remark,this.spinner.show(),this.dbService.FleetStart(this.CurrentTransactions).subscribe(i=>{this.spinner.hide();const o=i.message;if("success"==o){const c=new h.vA;c.disableClose=!0,c.autoFocus=!0,c.width="25%",c.data={KeyCode:this.keyEventList,data:i.ResponseData},this.dialogRef=this.dialog.open(P,c),this.dialogRef.afterClosed().subscribe(m=>{this.CurrentTransactions=null,this.getLaneRecentData(),this.reset_form(),this.dialogRef=null})}else this.DisplayMessage(o,!1)},i=>{this.spinner.hide(),this.DisplayMessage("Something went wrong !",!1)})):this.DisplayMessage("Wrong exempt type selection!",!1))})}}submit_trans(){if(null==this.CurrentTransactions)this.DisplayMessage("No transactions found!",!1);else{if(0==this.CurrentTransactions.VehicleClassId)return void this.DisplayMessage("Vehicle class is required!",!1);if(0==this.CurrentTransactions.TransactionTypeId)this.DisplayMessage("Transactions type is required!",!1);else{const s=this.FormDetails.value.PlateNumber,t=this.FormDetails.value.Remark;s.length<4?this.DisplayMessage("Plate number is required!",!1):(3==this.CurrentTransactions.TransactionTypeId&&""==t&&this.DisplayMessage("Remark is required!",!1),this.CurrentTransactions.PlateNumber=s,this.CurrentTransactions.TCRemark=t,this.spinner.show(),this.dbService.ProcessTransactions(this.CurrentTransactions).subscribe(n=>{const i=n.message;"success"==i||this.DisplayMessage(i,!1)},n=>{this.spinner.hide(),this.DisplayMessage("Something went wrong !",!1)}))}}}}return(a=r).\u0275fac=function(s){return new(s||a)(e.Y36(D.t),e.Y36(g.v),e.Y36(v.t2),e.Y36(w),e.Y36(h.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-dashboard"]],viewQuery:function(s,t){if(1&s&&(e.Gf(J,7),e.Gf(W,7)),2&s){let n;e.iGM(n=e.CRH())&&(t.plateNumberInput=n.first),e.iGM(n=e.CRH())&&(t.remarkInput=n.first)}},hostBindings:function(s,t){1&s&&e.NdJ("keydown",function(i){return t.handleKeyDown(i)},!1,e.Jf7)},decls:163,vars:44,consts:[[1,"main-body"],[1,"body-top-part"],[1,"row"],[1,"col-md-2"],["optionLabel","SystemVehicleClassName","optionValue","SystemVehicleClassId",3,"options","ngModel","filter","ngModelChange","onChange"],[1,"col-md-12"],[1,"row","d-flex","justify-content-center","pd-tb-4"],[1,"col-md-6","d-flex","justify-content-center","pd-tb-4"],["type","button",1,"btn","wt-90",3,"ngClass","click"],[1,"col-md-12","pd-tb-4"],["type","button",1,"btn","btn-warning","wt-90"],[1,"col-md-4","trans-box"],[3,"formGroup"],[1,"col-md-6"],[1,"form-group","row"],["for","TransactionTypeName",1,"col-sm-6","col-form-label"],[1,"col-sm-6"],["formControlName","TransactionTypeName","type","text","pInputText","","autocomplete","off","placeholder","Transaction type","readonly","true",1,"form-control","lbl"],["for","VehicleClassName",1,"col-sm-6","col-form-label"],["formControlName","VehicleClassName","type","text","pInputText","","readonly","true","autocomplete","off","placeholder","Vehicle class",1,"form-control","lbl"],["for","VehicleWeight",1,"col-sm-6","col-form-label"],["formControlName","VehicleWeight","suffix","kg ","mode","decimal",1,"lbl"],["for","TollFare",1,"col-sm-6","col-form-label"],["formControlName","TollFare","prefix","\u20b9 ","mode","decimal",1,"lbl"],["for","TransactionSubTypeName",1,"col-sm-6","col-form-label"],["formControlName","TransactionSubTypeName","type","text","pInputText","","autocomplete","off","placeholder","Sub type",1,"form-control","lbl"],["for","VehicleClassSubName",1,"col-sm-6","col-form-label"],["formControlName","VehicleClassSubName","type","text","pInputText","","readonly","true","autocomplete","off","placeholder","Sub class",1,"form-control","lbl"],["for","OverweightPenalty",1,"col-sm-6","col-form-label"],["formControlName","TagPenalty","prefix","\u20b9 ","mode","decimal",1,"lbl"],["for","TagPenalty",1,"col-sm-6","col-form-label"],["for","JourneyTypeId",1,"col-sm-3","col-form-label"],[1,"flex","align-items-center","justify-content-start"],[1,"radio-group"],["inputId","testSingle","value","S","formControlName","JourneyTypeId"],["for","testSingle",1,"ml-2","text-white"],["inputId","testReturn","value","R","formControlName","JourneyTypeId"],["for","testReturn",1,"ml-2","text-white"],["for","PlateNumber",1,"col-sm-3","col-form-label"],[1,"col-sm-9"],["formControlName","PlateNumber","type","text","pInputText","","autocomplete","off","placeholder","Plate number",1,"form-control"],["plateNumberInput",""],["for","Remark",1,"col-sm-3","col-form-label"],["formControlName","Remark","type","text","pInputText","","autocomplete","off","placeholder","Remark",1,"form-control"],["remarkInput",""],["type","button",1,"btn","btn-danger","wt-90",3,"click"],["type","button",1,"btn","btn-success","wt-90",3,"click"],[1,"col-md-4"],["alt","LPIC Camera",1,"live-stream",3,"src"],[1,"body-bottom-part"],[1,"table-responsive","mt-1"],["styleClass","","selectionMode","single",3,"value","rowHover","scrollable","resizableColumns"],["dt",""],["pTemplate","header","styleClass","thead-light"],["pTemplate","body"],[1,"body-footer-part"],[1,"icon-row"],["class","icon-item justify-content-center",4,"ngFor","ngForOf"],[3,"pSelectableRow"],[1,"icon-item","justify-content-center"],[1,"icon-label","justify-content-center"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"fieldset")(5,"legend"),e._uU(6,"Vehicle Class"),e.qZA(),e.TgZ(7,"p-listbox",4),e.NdJ("ngModelChange",function(i){return t.selectedVehicleClasss=i})("onChange",function(i){return t.onVehicleChange(i.value)}),e.qZA()()(),e.TgZ(8,"div",3)(9,"div",2)(10,"div",5)(11,"fieldset")(12,"legend"),e._uU(13,"Transaction Type"),e.qZA(),e.TgZ(14,"div",6)(15,"div",7)(16,"button",8),e.NdJ("click",function(){return t.onttySeclect(1,"FasTag")}),e._uU(17,"FasTag"),e.qZA()(),e.TgZ(18,"div",7)(19,"button",8),e.NdJ("click",function(){return t.onttySeclect(3,"Excempt")}),e._uU(20,"Excempt"),e.qZA()(),e.TgZ(21,"div",7)(22,"button",8),e.NdJ("click",function(){return t.onttySeclect(2,"Cash")}),e._uU(23,"Cash"),e.qZA()(),e.TgZ(24,"div",7)(25,"button",8),e.NdJ("click",function(){return t.onttySeclect(5,"Retrun")}),e._uU(26,"Retrun"),e.qZA()()()()(),e.TgZ(27,"div",9)(28,"fieldset")(29,"legend"),e._uU(30,"Transaction Event"),e.qZA(),e.TgZ(31,"div",6)(32,"div",7)(33,"button",8),e.NdJ("click",function(){return t.onFleetStart()}),e._uU(34),e.qZA()(),e.TgZ(35,"div",7)(36,"button",8),e.NdJ("click",function(){return t.ontteSeclect(2)}),e._uU(37),e.qZA()(),e.TgZ(38,"div",7)(39,"button",10),e._uU(40,"VRN"),e.qZA()(),e.TgZ(41,"div",7)(42,"button",10),e._uU(43,"Mid-Declare"),e.qZA()()()()()()(),e.TgZ(44,"div",11)(45,"fieldset")(46,"legend"),e._uU(47,"Current Transaction"),e.qZA(),e.TgZ(48,"form",12)(49,"div",2)(50,"div",13)(51,"div",14)(52,"label",15),e._uU(53,"Transaction Type:"),e.qZA(),e.TgZ(54,"div",16),e._UZ(55,"input",17),e.qZA()(),e.TgZ(56,"div",14)(57,"label",18),e._uU(58,"Vehicle class:"),e.qZA(),e.TgZ(59,"div",16),e._UZ(60,"input",19),e.qZA()(),e.TgZ(61,"div",14)(62,"label",20),e._uU(63,"Vehicle Weight:"),e.qZA(),e.TgZ(64,"div",16),e._UZ(65,"p-inputNumber",21),e.qZA()(),e.TgZ(66,"div",14)(67,"label",22),e._uU(68,"Toll Fare:"),e.qZA(),e.TgZ(69,"div",16),e._UZ(70,"p-inputNumber",23),e.qZA()()(),e.TgZ(71,"div",13)(72,"div",14)(73,"label",24),e._uU(74,"Sub Type:"),e.qZA(),e.TgZ(75,"div",16),e._UZ(76,"input",25),e.qZA()(),e.TgZ(77,"div",14)(78,"label",26),e._uU(79,"Sub class:"),e.qZA(),e.TgZ(80,"div",16),e._UZ(81,"input",27),e.qZA()(),e.TgZ(82,"div",14)(83,"label",28),e._uU(84,"Overweight(P):"),e.qZA(),e.TgZ(85,"div",16),e._UZ(86,"p-inputNumber",29),e.qZA()(),e.TgZ(87,"div",14)(88,"label",30),e._uU(89,"Tag Penalty:"),e.qZA(),e.TgZ(90,"div",16),e._UZ(91,"p-inputNumber",29),e.qZA()()()(),e.TgZ(92,"div",2)(93,"div",5)(94,"div",14)(95,"label",31),e._uU(96,"Journey Type:"),e.qZA(),e.TgZ(97,"div",16)(98,"div",32)(99,"div",33),e._UZ(100,"p-radioButton",34),e.TgZ(101,"label",35),e._uU(102,"Single"),e.qZA()(),e.TgZ(103,"div",33),e._UZ(104,"p-radioButton",36),e.TgZ(105,"label",37),e._uU(106,"Return"),e.qZA()()()()(),e.TgZ(107,"div",14)(108,"label",38),e._uU(109,"Plate Number:"),e.qZA(),e.TgZ(110,"div",39),e._UZ(111,"input",40,41),e.qZA()(),e.TgZ(113,"div",14)(114,"label",42),e._uU(115,"Remark:"),e.qZA(),e.TgZ(116,"div",39),e._UZ(117,"input",43,44),e.qZA()(),e.TgZ(119,"div",14)(120,"div",7)(121,"button",45),e.NdJ("click",function(){return t.reset_form()}),e._uU(122,"Reset"),e.qZA()(),e.TgZ(123,"div",7)(124,"button",46),e.NdJ("click",function(){return t.submit_trans()}),e._uU(125,"Submit"),e.qZA()()()()()()()(),e.TgZ(126,"div",47)(127,"fieldset")(128,"legend"),e._uU(129,"Live View"),e.qZA(),e._UZ(130,"img",48),e.qZA()()()(),e.TgZ(131,"div",49)(132,"div",2)(133,"div",47)(134,"fieldset")(135,"legend"),e._uU(136,"RFID Queue"),e.qZA(),e.TgZ(137,"div",50)(138,"p-table",51,52),e.YNc(140,L,11,0,"ng-template",53),e.YNc(141,Q,11,6,"ng-template",54),e.qZA()()()(),e.TgZ(142,"div",47)(143,"fieldset")(144,"legend"),e._uU(145,"WIM Queue"),e.qZA(),e.TgZ(146,"div",50)(147,"p-table",51,52),e.YNc(149,B,9,0,"ng-template",53),e.YNc(150,Y,9,5,"ng-template",54),e.qZA()()()(),e.TgZ(151,"div",47)(152,"fieldset")(153,"legend"),e._uU(154,"Recent Transaction"),e.qZA(),e.TgZ(155,"div",50)(156,"p-table",51,52),e.YNc(158,j,11,0,"ng-template",53),e.YNc(159,z,12,12,"ng-template",54),e.qZA()()()()()(),e.TgZ(160,"div",55)(161,"div",56),e.YNc(162,H,4,3,"span",57),e.qZA()()()),2&s&&(e.xp6(7),e.Q6J("options",t.VehicleClasss)("ngModel",t.selectedVehicleClasss)("filter",!1),e.xp6(9),e.Q6J("ngClass",e.WLB(26,_,"FasTag"!==t.ttyselectedButton,"FasTag"===t.ttyselectedButton)),e.xp6(3),e.Q6J("ngClass",e.WLB(29,_,"Excempt"!==t.ttyselectedButton,"Excempt"===t.ttyselectedButton)),e.xp6(3),e.Q6J("ngClass",e.WLB(32,_,"Cash"!==t.ttyselectedButton,"Cash"===t.ttyselectedButton)),e.xp6(3),e.Q6J("ngClass",e.WLB(35,_,"Retrun"!==t.ttyselectedButton,"Retrun"===t.ttyselectedButton)),e.xp6(8),e.Q6J("ngClass",e.WLB(38,E,0==t.FleetStart,t.FleetStart)),e.xp6(1),e.hij(" ",t.FleetStart?"Fleet-Started":"Fleet-Start"," "),e.xp6(2),e.Q6J("ngClass",e.WLB(41,E,0==t.TowStart,t.TowStart)),e.xp6(1),e.hij(" ",t.TowStart?"Tow-Started":"Tow-Start"," "),e.xp6(11),e.Q6J("formGroup",t.FormDetails),e.xp6(82),e.Q6J("src",t.lpicViewUrl,e.LSH),e.xp6(8),e.Q6J("value",t.rfidDataQueue)("rowHover",!0)("scrollable",!0)("resizableColumns",!0),e.xp6(9),e.Q6J("value",t.wimDataQueue)("rowHover",!0)("scrollable",!0)("resizableColumns",!0),e.xp6(9),e.Q6J("value",t.laneRecentData)("rowHover",!0)("scrollable",!0)("resizableColumns",!0),e.xp6(6),e.Q6J("ngForOf",t.equipmentListDetais))},dependencies:[T.mk,T.sg,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,u.On,A.jx,b.iA,b.Ei,x.Rn,U.EU,R.o,y.Ri,T.H9],encapsulation:2}),r})(),M=(()=>{var a;class r{constructor(){}ngOnInit(){}RedirecttoWallet(){document.getElementById("dvCountDown")}}return(a=r).\u0275fac=function(s){return new(s||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-page-not-found"]],decls:14,vars:0,consts:[["id","not-found"],[1,"circles"],["id","dvCountDown",1,"root",2,"display","none"],["id","lblCount"],[1,"circle","big"],[1,"circle","med"],[1,"circle","small"]],template:function(s,t){1&s&&(e.TgZ(0,"section",0)(1,"div",1)(2,"p"),e._uU(3,"404"),e._UZ(4,"br"),e.TgZ(5,"small"),e._uU(6,"PAGE NOT FOUND"),e.qZA()(),e.TgZ(7,"div",2),e._uU(8," You will be redirect on login after "),e._UZ(9,"span",3),e._uU(10,"\xa0seconds. "),e.qZA(),e._UZ(11,"span",4)(12,"span",5)(13,"span",6),e.qZA()())},styles:['body[_ngcontent-%COMP%]{width:100%;height:100%;background:#48A9E6;font-family:Raleway,sans-serif;font-weight:300;margin:0;padding:0}#title[_ngcontent-%COMP%]{text-align:center;font-size:40px;margin-top:40px;margin-bottom:-40px;position:relative;color:#fff}.circles[_ngcontent-%COMP%]:after{content:"";display:inline-block;width:100%;height:100px;background:transparent;position:absolute;top:-50px;left:0;transform:skewY(-4deg);-webkit-transform:skewY(-4deg)}.circles[_ngcontent-%COMP%]{height:100vh;background:transparent;text-align:center;position:relative;margin-top:-60px;box-shadow:inset -1px -4px 4px #0003}.circles[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:240px;color:#ff8a8a;padding-top:60px;position:relative;z-index:9;line-height:100%}.circles[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:40px;line-height:100%;vertical-align:top}.circles[_ngcontent-%COMP%]   .circle.small[_ngcontent-%COMP%]{width:140px;height:140px;border-radius:50%;background:#48A9E6;position:absolute;z-index:1;top:80px;left:50%;animation:7s _ngcontent-%COMP%_smallmove infinite cubic-bezier(1,.22,.71,.98);-webkit-animation:7s _ngcontent-%COMP%_smallmove infinite cubic-bezier(1,.22,.71,.98);animation-delay:1.2s;-webkit-animation-delay:1.2s}.circles[_ngcontent-%COMP%]   .circle.med[_ngcontent-%COMP%]{width:200px;height:200px;border-radius:50%;background:#48A9E6;position:absolute;z-index:1;top:0;left:10%;animation:7s _ngcontent-%COMP%_medmove infinite cubic-bezier(.32,.04,.15,.75);-webkit-animation:7s _ngcontent-%COMP%_medmove infinite cubic-bezier(.32,.04,.15,.75);animation-delay:.4s;-webkit-animation-delay:.4s}.circles[_ngcontent-%COMP%]   .circle.big[_ngcontent-%COMP%]{width:400px;height:400px;border-radius:50%;background:#48A9E6;position:absolute;z-index:1;top:200px;right:0;animation:8s _ngcontent-%COMP%_bigmove infinite;-webkit-animation:8s _ngcontent-%COMP%_bigmove infinite;animation-delay:3s;-webkit-animation-delay:1s}@keyframes _ngcontent-%COMP%_smallmove{0%{top:10px;left:45%;opacity:1}25%{top:300px;left:40%;opacity:.7}50%{top:240px;left:55%;opacity:.4}75%{top:100px;left:40%;opacity:.6}to{top:10px;left:45%;opacity:1}}@keyframes _ngcontent-%COMP%_medmove{0%{top:0;left:20%;opacity:1}25%{top:300px;left:80%;opacity:.7}50%{top:240px;left:55%;opacity:.4}75%{top:100px;left:40%;opacity:.6}to{top:0;left:20%;opacity:1}}@keyframes _ngcontent-%COMP%_bigmove{0%{top:0;right:4%;opacity:.5}25%{top:100px;right:40%;opacity:.4}50%{top:240px;right:45%;opacity:.8}75%{top:100px;right:35%;opacity:.6}to{top:0;right:4%;opacity:.5}}.root[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;color:#ff6f00;text-transform:uppercase;font-family:-apple-system,BlinkMacSystemFont,Arial,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica,sans-serif;font-size:1.5em;text-shadow:2px 2px 10px rgba(0,0,0,.2)}body[_ngcontent-%COMP%]{background:transparent;margin:0;padding:0}@keyframes _ngcontent-%COMP%_dots{50%{transform:translateY(-.4rem)}to{transform:translateY(0)}}.d[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_dots 1.5s ease-out infinite}.d-2[_ngcontent-%COMP%]{animation-delay:.5s}.d-3[_ngcontent-%COMP%]{animation-delay:1s}']}),r})();function G(a,r){1&a&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"TID"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"EPC"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Date Time"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"VRN"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Class"),e.qZA()())}function K(a,r){if(1&a&&(e.TgZ(0,"tr",54)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA()()),2&a){const l=r.$implicit;e.Q6J("pSelectableRow",l),e.xp6(2),e.Oqu(l.TID),e.xp6(2),e.Oqu(l.EPC),e.xp6(2),e.Oqu(l.TransactionDateTime),e.xp6(2),e.Oqu(l.Plate),e.xp6(2),e.Oqu(l.Class)}}function X(a,r){1&a&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Date Time"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Axle Count"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Total Weight"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Reverse Direction"),e.qZA()())}function ee(a,r){if(1&a&&(e.TgZ(0,"tr",54)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA()()),2&a){const l=r.$implicit;e.Q6J("pSelectableRow",l),e.xp6(2),e.Oqu(l.TransactionDateTime),e.xp6(2),e.Oqu(l.AxleCount),e.xp6(2),e.Oqu(l.TotalWeight),e.xp6(2),e.Oqu(l.IsReverseDirection)}}function te(a,r){1&a&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Id"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Type"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Vehicle"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Date Time"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Toll Fare"),e.qZA()())}function se(a,r){if(1&a&&(e.TgZ(0,"tr",54)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA()()),2&a){const l=r.$implicit;e.Q6J("pSelectableRow",l),e.xp6(2),e.Oqu(l.LaneTransactionId),e.xp6(2),e.Oqu(l.TransactionTypeName),e.xp6(2),e.AsE("",l.VehicleClassName,"-",l.VehicleSubClassName,""),e.xp6(2),e.Oqu(l.TransactionDateTime),e.xp6(2),e.Oqu(e.gM2(11,7,l.TransactionAmount,"INR","symbol","1.0-2"))}}function ne(a,r){if(1&a&&(e.TgZ(0,"span",55),e._UZ(1,"i"),e.TgZ(2,"div",56),e._uU(3),e.qZA()()),2&a){const l=r.$implicit,s=e.oxw();e.xp6(1),e.Tol(s.getIconName(l)),e.xp6(2),e.Oqu(l.EquipmentTypeName)}}const S=function(a,r){return{"btn-outline-info":a,"btn-dark":r}},k=function(a,r){return{"btn-outline-warning":a,"btn-dark":r}},ie=[{path:"dashboard",component:$},{path:"etcdashboard",component:(()=>{var a;class r{constructor(s,t,n,i,o){this.dbService=s,this.dm=t,this.spinner=n,this.webSocketService=i,this.dialog=o,this.laneRecentData=[],this.wimDataQueue=[],this.rfidDataQueue=[],this.equipmentListDetais=null,this.SystemSetting=null,this.selectedVehicleClasss=0,this.excludeIds=[24,6,25,13,8,11],this.CurrentTransactions=null,this.ttyselectedButton="",this.tteselectedButton="",this.FleetStart=!1,this.TowStart=!1,this.apiPath="",this.lpicViewUrl="",this.destroy$=new Z.x,this.UserData=this.dm.getUserData()}ngOnInit(){this.FormDetails=new u.cw({TransactionTypeName:new u.NI("",[u.kI.required]),TransactionSubTypeName:new u.NI("",[u.kI.required]),VehicleClassName:new u.NI("",[u.kI.required]),VehicleClassSubName:new u.NI("",[u.kI.required]),JourneyTypeId:new u.NI("S",[u.kI.required]),PlateNumber:new u.NI("",[]),Remark:new u.NI("",[]),VehicleWeight:new u.NI("0",[]),TollFare:new u.NI("0",[]),OverweightPenalty:new u.NI("0",[]),TagPenalty:new u.NI("0",[])}),this.getLaneMasterData(),this.messageSubscription=this.webSocketService.getMessages().pipe((0,q.R)(this.destroy$)).subscribe(s=>{""!=s&&this.process_ws_message(s)},s=>console.error("WebSocket error:",s)),this.refreshImageUrl()}refreshImageUrl(){const s=(new Date).getTime();this.lpicViewUrl=this.dm.getDataAPI()+`/lpicLiveView?timestamp=${s}`}reset_form(){this.ttyselectedButton="",this.tteselectedButton="",this.FormDetails.reset(),this.FormDetails.controls.TransactionTypeName.setValue(""),this.FormDetails.controls.TransactionSubTypeName.setValue(""),this.FormDetails.controls.VehicleClassName.setValue(""),this.FormDetails.controls.VehicleClassSubName.setValue(""),this.FormDetails.controls.JourneyTypeId.setValue("S"),this.FormDetails.controls.PlateNumber.setValue(""),this.FormDetails.controls.Remark.setValue(""),this.FormDetails.controls.VehicleWeight.setValue(0),this.FormDetails.controls.TollFare.setValue(0),this.FormDetails.controls.OverweightPenalty.setValue(0),this.FormDetails.controls.TagPenalty.setValue(0),this.selectedVehicleClasss=0}getLaneMasterData(){this.spinner.show(),this.dbService.getLaneMasterData().subscribe(s=>{if(this.getLaneRecentData(),"success"==s.message){const n=s.ResponseData,i=n.master_data,o=n.hardware_list,c=n.equipment_detail,I=i[0].concat(i[1]);this.equipmentListDetais=I.filter(d=>!this.excludeIds.includes(d.EquipmentTypeId)),this.TransactionTypeMaster=i[2],this.PaymentTypeMaster=i[3],this.ExemptTypeMaster=i[4],this.VehicleClasss=i[5],this.VehicleSubClasss=i[6],this.ShiftTimining=i[7],this.TollFare=i[8],this.SystemSetting=i[9].length>0?i[9][0]:null,this.PlazaDetails=i[10],this.LaneDetails=i[11],o.forEach(d=>{this.updateEquipmentStatus(d.EquipmentTypeId,d.PositionStatus,"hardware_on_off_status")}),c.forEach(d=>{this.updateEquipmentStatus(d.EquipmentTypeId,d.OnLineStatus,"equipment_status")})}else this.DisplayMessage("Somthing went wrong!",!1)},()=>{this.spinner.hide(),this.DisplayMessage("Somthing went wrong!",!1)})}getLaneRecentData(){this.dbService.getLaneRecentData().subscribe(s=>{this.spinner.hide(),"success"==s.message?this.laneRecentData=s.ResponseData:this.DisplayMessage("Somthing went wrong!",!1)},()=>{this.spinner.hide(),this.DisplayMessage("Somthing went wrong!",!1)})}addTrsnaRow(s){this.laneRecentData.unshift(s),this.laneRecentData.length>10&&this.laneRecentData.pop()}DisplayMessage(s,t){this.dm.openSnackBar([{AlertMessage:s}],t)}bindData(s,t,n){if("vc"==s)this.CurrentTransactions.VehicleClassId=t.SystemVehicleClassId,this.CurrentTransactions.VehicleClassName=t.SystemVehicleClassName,this.CurrentTransactions.PermissibleVehicleWeight=t.PermissibleWeight,this.FormDetails.controls.VehicleClassName.setValue(t.SystemVehicleClassName),this.getTollFare();else if("svc"==s)t.SystemVehicleClassId>0&&(this.CurrentTransactions.VehicleClassId=t.SystemVehicleClassId,this.CurrentTransactions.VehicleClassName=t.SystemVehicleClassName,this.CurrentTransactions.PermissibleVehicleWeight=t.PermissibleWeight,this.FormDetails.controls.VehicleClassName.setValue(t.SystemVehicleClassName)),this.CurrentTransactions.VehicleSubClassId=t.SystemVehicleSubClassId,this.CurrentTransactions.VehicleSubClassName=t.SystemVehicleSubClassName,this.CurrentTransactions.PermissibleVehicleWeight=t.PermissibleWeight,this.FormDetails.controls.VehicleClassSubName.setValue(t.SystemVehicleSubClassName),this.getTollFare();else if("tt"==s){if(this.CurrentTransactions.TransactionTypeId=t.TransactionTypeId,this.CurrentTransactions.TransactionTypeName=t.TransactionTypeName,this.CurrentTransactions.PaymentTypeId=0,this.CurrentTransactions.ExemptTypeId=0,this.CurrentTransactions.PaymentTypeName="",this.CurrentTransactions.ExemptTypeName="",this.FormDetails.controls.TransactionTypeName.setValue(t.TransactionTypeName),this.FormDetails.controls.TransactionSubTypeName.setValue(""),this.FormDetails.controls.Remark.setValue(""),null!=n){console.log(n);const i=parseInt(n.Class);this.CurrentTransactions.TagEPC=n.EPC,this.CurrentTransactions.RCTNumber=n.TID,this.CurrentTransactions.TagPlateNumber=n.Plate,this.CurrentTransactions.TagReadDateTime=n.TransactionDateTime,this.CurrentTransactions.TagReadCount=0,this.CurrentTransactions.TagReadById=n.TagReadById,this.CurrentTransactions.TagClassId=i;let o=this.VehicleSubClasss.filter(c=>c.SystemVehicleSubClassId==i);console.log(o),o.length>0&&(o=o[0],this.CurrentTransactions.VehicleClassId=parseInt(n.Class),this.CurrentTransactions.VehicleSubClassId=parseInt(n.Class),o.SystemVehicleClassId>0&&(this.CurrentTransactions.VehicleClassId=o.SystemVehicleClassId,this.CurrentTransactions.VehicleClassName=o.SystemVehicleClassName,this.CurrentTransactions.PermissibleVehicleWeight=o.PermissibleWeight,this.FormDetails.controls.VehicleClassName.setValue(o.SystemVehicleClassName),this.selectedVehicleClasss=o.SystemVehicleClassId),this.CurrentTransactions.VehicleSubClassId=o.SystemVehicleSubClassId,this.CurrentTransactions.VehicleSubClassName=o.SystemVehicleSubClassName,this.CurrentTransactions.PermissibleVehicleWeight=o.PermissibleWeight,this.FormDetails.controls.VehicleClassSubName.setValue(o.SystemVehicleSubClassName))}this.getTollFare()}else"pt"==s?(this.CurrentTransactions.PaymentTypeId=t.PaymentTypeId,this.CurrentTransactions.PaymentTypeName=t.PaymentTypeName,this.FormDetails.controls.TransactionSubTypeName.setValue(t.PaymentTypeName),this.FormDetails.controls.Remark.setValue("")):"et"==s&&(this.CurrentTransactions.ExemptTypeId=t.ExemptTypeId,this.CurrentTransactions.ExemptTypeName=t.ExemptTypeName,this.FormDetails.controls.TransactionSubTypeName.setValue(t.ExemptTypeName),this.FormDetails.controls.Remark.setValue(t.ExemptTypeName))}getCurrentTransactions(s,t,n){this.dbService.getCurrentTransactions().subscribe(i=>{this.CurrentTransactions=i.ResponseData,this.bindData(s,t,n)},()=>{this.spinner.hide(),this.DisplayMessage("Somthing went wrong!",!1)})}createTrans(s,t,n){null==this.CurrentTransactions?this.getCurrentTransactions(s,t,n):this.bindData(s,t,n)}onVehicleChange(s){let t=this.VehicleClasss.filter(n=>n.SystemVehicleClassId==s);if(t=t.length>0?t[0]:null,null!=t){this.createTrans("vc",t,null);const n=this.VehicleSubClasss.filter(i=>i.SystemVehicleClassId==s);if(n.length>1){const i=new h.vA;i.disableClose=!0,i.autoFocus=!0,i.width="25%",i.data=n,this.dialog.open(V,i).afterClosed().subscribe(c=>{c&&(null!=c?this.createTrans("svc",c,null):this.DisplayMessage("Wrong sub class selection!",!1))})}else 1==n.length?this.createTrans("svc",n[0],null):this.DisplayMessage("Wrong sub class selection!",!1)}else this.DisplayMessage("Wrong class selection!",!1)}ontteSeclect(s){1==s&&(this.TowStart?this.DisplayMessage("Stop the tow first!",!1):this.FleetStart=!this.FleetStart),2==s&&(this.FleetStart?this.DisplayMessage("Stop the fleet first!",!1):this.TowStart=!this.TowStart)}onttySeclect(s,t){if(this.ttyselectedButton=t,5!=s)if(this.createTrans("tt",{TransactionTypeId:s,TransactionTypeName:t},null),this.FormDetails.controls.JourneyTypeId.enable(),this.FormDetails.controls.JourneyTypeId.setValue("S"),this.FormDetails.controls.JourneyTypeId.disable(),2==s){this.FormDetails.controls.JourneyTypeId.enable();const i=new h.vA;i.disableClose=!0,i.autoFocus=!0,i.width="25%",i.data=this.PaymentTypeMaster,this.dialog.open(F,i).afterClosed().subscribe(c=>{c&&(null!=c?this.createTrans("pt",c,null):this.DisplayMessage("Wrong payment type selection!",!1))})}else if(3==s){this.FormDetails.controls.JourneyTypeId.disable();const i=new h.vA;i.disableClose=!0,i.autoFocus=!0,i.width="25%",i.data=this.ExemptTypeMaster,this.dialog.open(C,i).afterClosed().subscribe(c=>{c&&(null!=c?this.createTrans("et",c,null):this.DisplayMessage("Wrong exempt type selection!",!1))})}}process_ws_message_get(s){try{s.indexOf("}{")}catch(t){console.log(s),console.log(t)}}process_ws_message(s){try{if(""!=s){let t=JSON.parse(s);const n=t.topic;if("equipment_status"==n)this.updateEquipmentStatus(t.EquipmentTypeId,t.OnLineStatus,n);else if("hardware_on_off_status"==n)this.updateEquipmentStatus(t.EquipmentTypeId,t.PositionStatus,n);else if("wim_processed"==n)this.process_wim_data(t);else if("rfid_processed"==n)this.process_rfid_data(t);else if("lane_process_end"==n&&(this.CurrentTransactions=null,this.getLaneRecentData(),this.reset_form(),this.rfidDataQueue.length>0)){const i=this.rfidDataQueue[0];this.rfidDataQueue.shift();const o={TransactionTypeId:1,TransactionTypeName:"FasTag"};this.ttyselectedButton=o.TransactionTypeName,this.createTrans("tt",o,i)}}}catch(t){console.error("Error parsing JSON:",t,"JSON string:",s)}}process_wim_data(s){this.wimDataQueue.push(s)}process_ws_message_bkp(s){if(""!=s)try{let t=s.split("}{").map((n,i,o)=>{0!==i&&(n="{"+n),i!==o.length-1&&(n+="}");try{return JSON.parse(n)}catch(c){return console.error("Error parsing JSON:",c,"JSON string:",n),null}});t?.forEach(n=>{const i=n.topic,o=n;if("hardware_on_off_status"==i)this.updateEquipmentStatus(o.EquipmentTypeId,o.PositionStatus,i);else if("wim_processed"!=i)if("rfid_processed"==i)this.process_rfid_data(o);else if("avc_processed"!=i&&"lane_processed"!=i&&"lane_process_end"==i&&(this.CurrentTransactions=null,this.getLaneRecentData(),this.reset_form(),this.rfidDataQueue.length>0)){const c=this.rfidDataQueue[0];this.rfidDataQueue.shift();const m={TransactionTypeId:1,TransactionTypeName:"FasTag"};this.ttyselectedButton=m.TransactionTypeName,this.createTrans("tt",m,c)}})}catch(t){console.log(s),console.log(t)}}process_rfid_data(s){if(null==this.CurrentTransactions)if(0==this.rfidDataQueue.length){const t={TransactionTypeId:1,TransactionTypeName:"FasTag"};this.ttyselectedButton=t.TransactionTypeName,this.createTrans("tt",t,s)}else this.rfidDataQueue.push(s);else this.rfidDataQueue.push(s)}updateEquipmentStatus(s,t,n){if(null!=this.equipmentListDetais){const i=this.equipmentListDetais.find(o=>o.EquipmentTypeId===s);i&&("equipment_status"==n?i.OnLineStatus=t:"hardware_on_off_status"==n&&(i.PositionStatus=t))}}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe()}getIconName(s){let t=s.EquipmentIcon;const n=1===s.OnLineStatus||!0===s.OnLineStatus,i=1===s.ConnectionStatus||!0===s.ConnectionStatus,o=1===s.PositionStatus||!0===s.PositionStatus;try{const c=t.split("/");return t=2==c.length&&o?c[1]:c[0],1==s.ProtocolTypeId||2==s.ProtocolTypeId||4==s.ProtocolTypeId||5==s.ProtocolTypeId||6==s.ProtocolTypeId||8==s.ProtocolTypeId?n&&i?t+" txt-green":n?t+" txt-yellow":t+" txt-red":(t=o?c[1]+" txt-green":c[0]+" txt-red",t)}catch{return t}}getTollFare(){let s=null,t=null;this.wimDataQueue.length>0&&(t=this.wimDataQueue[0],this.wimDataQueue.shift()),null!=this.CurrentTransactions&&null!=this.SystemSetting&&null!=this.TollFare&&this.CurrentTransactions.TransactionTypeId>0&&(1==this.SystemSetting.TollFareonSubClass||1==this.SystemSetting.TollFareonSubClass?this.CurrentTransactions.VehicleSubClassId>0&&(s=this.TollFare.filter(n=>n.SubVehicleClassId==this.CurrentTransactions.VehicleSubClassId)):this.CurrentTransactions.VehicleClassId>0&&(s=this.TollFare.filter(n=>n.SystemVehicleClassId==this.CurrentTransactions.VehicleClassId))),null!=s&&s.length>0?(s=s[0],2==this.CurrentTransactions.TransactionTypeId?(this.FormDetails.controls.TollFare.setValue(s.TollFare),this.CurrentTransactions.TransactionAmount=s.TollFare,1==this.SystemSetting.FasTagPenalty||1==this.SystemSetting.FasTagPenalty?(this.CurrentTransactions.TagPenaltyAmount=s.FasTagPenalty,this.FormDetails.controls.TagPenalty.setValue(s.FasTagPenalty)):(this.CurrentTransactions.TagPenaltyAmount=0,this.FormDetails.controls.TagPenalty.setValue(0))):(this.CurrentTransactions.TransactionAmount=0,this.FormDetails.controls.TollFare.setValue(0),this.CurrentTransactions.TagPenaltyAmount=0,this.FormDetails.controls.TagPenalty.setValue(0))):(this.CurrentTransactions.TransactionAmount=0,this.CurrentTransactions.TagPenaltyAmount=0,this.CurrentTransactions.OverweightPenalty=0,this.FormDetails.controls.TollFare.setValue(0),this.FormDetails.controls.OverweightPenalty.setValue(0),this.FormDetails.controls.TagPenalty.setValue(0),this.CurrentTransactions.TransactionTypeId>0&&(this.CurrentTransactions.VehicleClassId>0||this.CurrentTransactions.VehicleSubClassId>0)&&this.DisplayMessage("Toll Fare not found for selected class !",!1)),null!=t?(this.CurrentTransactions.ActualVehicleWeight=t.TotalWeight,this.CurrentTransactions.ActualVehicleWeight>this.CurrentTransactions.PermissibleVehicleWeight&&null!=s?(this.CurrentTransactions.OverweightPenalty=s.OverweightPenalty,this.FormDetails.controls.OverweightPenalty.setValue(s.OverweightPenalty)):(this.CurrentTransactions.OverweightPenalty=0,this.FormDetails.controls.OverweightPenalty.setValue(0))):(this.CurrentTransactions.OverweightPenalty=0,this.FormDetails.controls.OverweightPenalty.setValue(0))}onFleetStart(){this.FormDetails.controls.JourneyTypeId.enable(),this.FormDetails.controls.JourneyTypeId.setValue("S"),this.FormDetails.controls.JourneyTypeId.disable(),this.createTrans("tt",{TransactionTypeId:3,TransactionTypeName:"Excempt"},null);const t=new h.vA;t.disableClose=!0,t.autoFocus=!0,t.width="25%",t.data=this.ExemptTypeMaster,this.dialog.open(C,t).afterClosed().subscribe(i=>{i&&(null!=i?(this.createTrans("et",i,null),this.CurrentTransactions.TCRemark=this.FormDetails.value.Remark,this.spinner.show(),this.dbService.FleetStart(this.CurrentTransactions).subscribe(o=>{this.spinner.hide();const c=o.message;if("success"==c){const m=new h.vA;m.disableClose=!0,m.autoFocus=!0,m.width="25%",m.data=o.ResponseData,this.dialog.open(P,m).afterClosed().subscribe(()=>{this.CurrentTransactions=null,this.getLaneRecentData(),this.reset_form()})}else this.DisplayMessage(c,!1)},()=>{this.spinner.hide(),this.DisplayMessage("Something went wrong !",!1)})):this.DisplayMessage("Wrong exempt type selection!",!1))})}submit_trans(){if(null==this.CurrentTransactions)this.DisplayMessage("No transactions found!",!1);else{if(0==this.CurrentTransactions.VehicleClassId)return void this.DisplayMessage("Vehicle class is required!",!1);if(0==this.CurrentTransactions.TransactionTypeId)this.DisplayMessage("Transactions type is required!",!1);else{const s=this.FormDetails.value.PlateNumber,t=this.FormDetails.value.Remark;s.length<4?this.DisplayMessage("Plate number is required!",!1):(3==this.CurrentTransactions.TransactionTypeId&&""==t&&this.DisplayMessage("Remark is required!",!1),this.CurrentTransactions.PlateNumber=s,this.CurrentTransactions.TCRemark=t,this.spinner.show(),this.dbService.ProcessTransactions(this.CurrentTransactions).subscribe(n=>{const i=n.message;"success"==i||this.DisplayMessage(i,!1)},()=>{this.spinner.hide(),this.DisplayMessage("Something went wrong !",!1)}))}}}}return(a=r).\u0275fac=function(s){return new(s||a)(e.Y36(D.t),e.Y36(g.v),e.Y36(v.t2),e.Y36(w),e.Y36(h.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-etc-dashboard"]],decls:154,vars:44,consts:[[1,"main-body"],[1,"body-top-part"],[1,"row"],[1,"col-md-2"],["optionLabel","SystemVehicleClassName","optionValue","SystemVehicleClassId",3,"options","ngModel","filter","ngModelChange","onChange"],[1,"col-md-12"],[1,"row","d-flex","justify-content-center","pd-tb-4"],[1,"col-md-6","d-flex","justify-content-center","pd-tb-4"],["type","button",1,"btn","wt-90",3,"ngClass","click"],[1,"col-md-12","pd-tb-4"],["type","button",1,"btn","btn-warning","wt-90"],[1,"col-md-4","trans-box"],[3,"formGroup"],[1,"col-md-6"],[1,"form-group","row"],["for","TransactionTypeName",1,"col-sm-6","col-form-label"],[1,"col-sm-6"],["formControlName","TransactionTypeName","type","text","pInputText","","autocomplete","off","placeholder","Transaction type","readonly","true",1,"form-control","lbl"],["for","VehicleClassName",1,"col-sm-6","col-form-label"],["formControlName","VehicleClassName","type","text","pInputText","","readonly","true","autocomplete","off","placeholder","Vehicle class",1,"form-control","lbl"],["for","VehicleWeight",1,"col-sm-6","col-form-label"],["formControlName","VehicleWeight","suffix","kg ","mode","decimal",1,"lbl"],["for","TollFare",1,"col-sm-6","col-form-label"],["formControlName","TollFare","prefix","\u20b9 ","mode","decimal",1,"lbl"],["for","TransactionSubTypeName",1,"col-sm-6","col-form-label"],["formControlName","TransactionSubTypeName","type","text","pInputText","","autocomplete","off","placeholder","Sub type",1,"form-control","lbl"],["for","VehicleClassSubName",1,"col-sm-6","col-form-label"],["formControlName","VehicleClassSubName","type","text","pInputText","","readonly","true","autocomplete","off","placeholder","Sub class",1,"form-control","lbl"],["for","OverweightPenalty",1,"col-sm-6","col-form-label"],["formControlName","TagPenalty","prefix","\u20b9 ","mode","decimal",1,"lbl"],["for","TagPenalty",1,"col-sm-6","col-form-label"],["for","JourneyTypeId",1,"col-sm-3","col-form-label"],[1,"flex","align-items-center","justify-content-start"],[1,"radio-group"],["inputId","testSingle","value","S","formControlName","JourneyTypeId"],["for","testSingle",1,"ml-2","text-white"],["inputId","testReturn","value","R","formControlName","JourneyTypeId"],["for","testReturn",1,"ml-2","text-white"],["for","PlateNumber",1,"col-sm-3","col-form-label"],[1,"col-sm-9"],["formControlName","PlateNumber","type","text","pInputText","","autocomplete","off","placeholder","Plate number",1,"form-control"],["for","Remark",1,"col-sm-3","col-form-label"],["formControlName","Remark","type","text","pInputText","","autocomplete","off","placeholder","Remark",1,"form-control"],[1,"col-md-4"],["alt","LPIC Camera",1,"live-stream",3,"src"],[1,"body-bottom-part"],[1,"table-responsive","mt-1"],["styleClass","","selectionMode","single",3,"value","rowHover","scrollable","resizableColumns"],["dt",""],["pTemplate","header","styleClass","thead-light"],["pTemplate","body"],[1,"body-footer-part"],[1,"icon-row"],["class","icon-item justify-content-center",4,"ngFor","ngForOf"],[3,"pSelectableRow"],[1,"icon-item","justify-content-center"],[1,"icon-label","justify-content-center"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"fieldset")(5,"legend"),e._uU(6,"Vehicle Class"),e.qZA(),e.TgZ(7,"p-listbox",4),e.NdJ("ngModelChange",function(i){return t.selectedVehicleClasss=i})("onChange",function(i){return t.onVehicleChange(i.value)}),e.qZA()()(),e.TgZ(8,"div",3)(9,"div",2)(10,"div",5)(11,"fieldset")(12,"legend"),e._uU(13,"Transaction Type"),e.qZA(),e.TgZ(14,"div",6)(15,"div",7)(16,"button",8),e.NdJ("click",function(){return t.onttySeclect(1,"FasTag")}),e._uU(17,"FasTag"),e.qZA()(),e.TgZ(18,"div",7)(19,"button",8),e.NdJ("click",function(){return t.onttySeclect(3,"Excempt")}),e._uU(20,"Excempt"),e.qZA()(),e.TgZ(21,"div",7)(22,"button",8),e.NdJ("click",function(){return t.onttySeclect(2,"Cash")}),e._uU(23,"Cash"),e.qZA()(),e.TgZ(24,"div",7)(25,"button",8),e.NdJ("click",function(){return t.onttySeclect(5,"Retrun")}),e._uU(26,"Retrun"),e.qZA()()()()(),e.TgZ(27,"div",9)(28,"fieldset")(29,"legend"),e._uU(30,"Transaction Event"),e.qZA(),e.TgZ(31,"div",6)(32,"div",7)(33,"button",8),e.NdJ("click",function(){return t.onFleetStart()}),e._uU(34),e.qZA()(),e.TgZ(35,"div",7)(36,"button",8),e.NdJ("click",function(){return t.ontteSeclect(2)}),e._uU(37),e.qZA()(),e.TgZ(38,"div",7)(39,"button",10),e._uU(40,"VRN"),e.qZA()(),e.TgZ(41,"div",7)(42,"button",10),e._uU(43,"Mid-Declare"),e.qZA()()()()()()(),e.TgZ(44,"div",11)(45,"fieldset")(46,"legend"),e._uU(47,"Current Transaction"),e.qZA(),e.TgZ(48,"form",12)(49,"div",2)(50,"div",13)(51,"div",14)(52,"label",15),e._uU(53,"Transaction Type:"),e.qZA(),e.TgZ(54,"div",16),e._UZ(55,"input",17),e.qZA()(),e.TgZ(56,"div",14)(57,"label",18),e._uU(58,"Vehicle class:"),e.qZA(),e.TgZ(59,"div",16),e._UZ(60,"input",19),e.qZA()(),e.TgZ(61,"div",14)(62,"label",20),e._uU(63,"Vehicle Weight:"),e.qZA(),e.TgZ(64,"div",16),e._UZ(65,"p-inputNumber",21),e.qZA()(),e.TgZ(66,"div",14)(67,"label",22),e._uU(68,"Toll Fare:"),e.qZA(),e.TgZ(69,"div",16),e._UZ(70,"p-inputNumber",23),e.qZA()()(),e.TgZ(71,"div",13)(72,"div",14)(73,"label",24),e._uU(74,"Sub Type:"),e.qZA(),e.TgZ(75,"div",16),e._UZ(76,"input",25),e.qZA()(),e.TgZ(77,"div",14)(78,"label",26),e._uU(79,"Sub class:"),e.qZA(),e.TgZ(80,"div",16),e._UZ(81,"input",27),e.qZA()(),e.TgZ(82,"div",14)(83,"label",28),e._uU(84,"Overweight(P):"),e.qZA(),e.TgZ(85,"div",16),e._UZ(86,"p-inputNumber",29),e.qZA()(),e.TgZ(87,"div",14)(88,"label",30),e._uU(89,"Tag Penalty:"),e.qZA(),e.TgZ(90,"div",16),e._UZ(91,"p-inputNumber",29),e.qZA()()()(),e.TgZ(92,"div",2)(93,"div",5)(94,"div",14)(95,"label",31),e._uU(96,"Journey Type:"),e.qZA(),e.TgZ(97,"div",16)(98,"div",32)(99,"div",33),e._UZ(100,"p-radioButton",34),e.TgZ(101,"label",35),e._uU(102,"Single"),e.qZA()(),e.TgZ(103,"div",33),e._UZ(104,"p-radioButton",36),e.TgZ(105,"label",37),e._uU(106,"Return"),e.qZA()()()()(),e.TgZ(107,"div",14)(108,"label",38),e._uU(109,"Plate Number:"),e.qZA(),e.TgZ(110,"div",39),e._UZ(111,"input",40),e.qZA()(),e.TgZ(112,"div",14)(113,"label",41),e._uU(114,"Remark:"),e.qZA(),e.TgZ(115,"div",39),e._UZ(116,"input",42),e.qZA()()()()()()(),e.TgZ(117,"div",43)(118,"fieldset")(119,"legend"),e._uU(120,"Live View"),e.qZA(),e._UZ(121,"img",44),e.qZA()()()(),e.TgZ(122,"div",45)(123,"div",2)(124,"div",43)(125,"fieldset")(126,"legend"),e._uU(127,"RFID Queue"),e.qZA(),e.TgZ(128,"div",46)(129,"p-table",47,48),e.YNc(131,G,11,0,"ng-template",49),e.YNc(132,K,11,6,"ng-template",50),e.qZA()()()(),e.TgZ(133,"div",43)(134,"fieldset")(135,"legend"),e._uU(136,"WIM Queue"),e.qZA(),e.TgZ(137,"div",46)(138,"p-table",47,48),e.YNc(140,X,9,0,"ng-template",49),e.YNc(141,ee,9,5,"ng-template",50),e.qZA()()()(),e.TgZ(142,"div",43)(143,"fieldset")(144,"legend"),e._uU(145,"Recent Transaction"),e.qZA(),e.TgZ(146,"div",46)(147,"p-table",47,48),e.YNc(149,te,11,0,"ng-template",49),e.YNc(150,se,12,12,"ng-template",50),e.qZA()()()()()(),e.TgZ(151,"div",51)(152,"div",52),e.YNc(153,ne,4,3,"span",53),e.qZA()()()),2&s&&(e.xp6(7),e.Q6J("options",t.VehicleClasss)("ngModel",t.selectedVehicleClasss)("filter",!1),e.xp6(9),e.Q6J("ngClass",e.WLB(26,S,"FasTag"!==t.ttyselectedButton,"FasTag"===t.ttyselectedButton)),e.xp6(3),e.Q6J("ngClass",e.WLB(29,S,"Excempt"!==t.ttyselectedButton,"Excempt"===t.ttyselectedButton)),e.xp6(3),e.Q6J("ngClass",e.WLB(32,S,"Cash"!==t.ttyselectedButton,"Cash"===t.ttyselectedButton)),e.xp6(3),e.Q6J("ngClass",e.WLB(35,S,"Retrun"!==t.ttyselectedButton,"Retrun"===t.ttyselectedButton)),e.xp6(8),e.Q6J("ngClass",e.WLB(38,k,0==t.FleetStart,t.FleetStart)),e.xp6(1),e.hij(" ",t.FleetStart?"Fleet-Started":"Fleet-Start"," "),e.xp6(2),e.Q6J("ngClass",e.WLB(41,k,0==t.TowStart,t.TowStart)),e.xp6(1),e.hij(" ",t.TowStart?"Tow-Started":"Tow-Start"," "),e.xp6(11),e.Q6J("formGroup",t.FormDetails),e.xp6(73),e.Q6J("src",t.lpicViewUrl,e.LSH),e.xp6(8),e.Q6J("value",t.rfidDataQueue)("rowHover",!0)("scrollable",!0)("resizableColumns",!0),e.xp6(9),e.Q6J("value",t.wimDataQueue)("rowHover",!0)("scrollable",!0)("resizableColumns",!0),e.xp6(9),e.Q6J("value",t.laneRecentData)("rowHover",!0)("scrollable",!0)("resizableColumns",!0),e.xp6(6),e.Q6J("ngForOf",t.equipmentListDetais))},dependencies:[T.mk,T.sg,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,u.On,A.jx,b.iA,b.Ei,x.Rn,U.EU,R.o,y.Ri,T.H9],encapsulation:2}),r})()},{path:"**",component:M},{path:"unauthorized",component:M}];let ae=(()=>{var a;class r{}return(a=r).\u0275fac=function(s){return new(s||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[g.v],imports:[O.Bz.forChild(ie)]}),r})()}}]);